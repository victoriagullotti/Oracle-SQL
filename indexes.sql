--CREATE TABLE AND FILL IT WITH DATA
CREATE TABLE members (
    members_id INT
        GENERATED BY DEFAULT AS IDENTITY,
    first_name VARCHAR2(100) NOT NULL,
    last_name  VARCHAR2(100) NOT NULL,
    dob        DATE NOT NULL,
    email      VARCHAR2(250) NOT NULL,
    PRIMARY KEY ( members_id )
);

INSERT INTO members VALUES (
    1,
    'Anna',
    'Perry',
    DATE '1994-02-22',
    'annaperey@gmail.com'
);

INSERT INTO members VALUES (
    0,
    'Olga',
    'Perry',
    DATE '1992-02-07',
    'perey@gmail.com'
);

INSERT INTO members VALUES (
    2,
    'John',
    'Moore',
    DATE '1992-02-07',
    'jm@gmail.com'
);

INSERT INTO members VALUES (
    3,
    'John',
    'Moore',
    DATE '1992-02-07',
    'jm@gmail.com'
);

INSERT INTO members VALUES (
    4,
    'John',
    'Moore',
    DATE '1992-02-07',
    'jm@gmail.com'
);

INSERT INTO members VALUES (
    5,
    'John',
    'Moore',
    DATE '1992-02-07',
    'jm@gmail.com'
);

INSERT INTO members VALUES (
    6,
    'John',
    'Moore',
    DATE '1992-02-07',
    'jm@gmail.com'
);

INSERT INTO members VALUES (
    7,
    'John',
    'Moore',
    DATE '1992-02-07',
    'jm@gmail.com'
);

INSERT INTO members VALUES (
    8,
    'John',
    'Moore',
    DATE '1992-02-07',
    'jm@gmail.com'
);

INSERT INTO members VALUES (
    9,
    'John',
    'Moore',
    DATE '1992-02-07',
    'jm@gmail.com'
);

INSERT INTO members VALUES (
    10,
    'John',
    'Moore',
    DATE '1992-02-07',
    'jm@gmail.com'
);

INSERT INTO members VALUES (
    11,
    'John',
    'Moore',
    DATE '1992-02-07',
    'jm@gmail.com'
);

COMMIT;

SELECT
    *
FROM
    members;

--SEE ALL INDEXES
SELECT
    *
FROM
    all_indexes i
WHERE
    i.table_name = 'MEMBERS';

--CREATE INDEX FOR FIRST NAME AND LAST NAME SEARCH
CREATE INDEX ind_members_01 ON
    members (
        members_id,
        first_name
    );

SELECT
    *
FROM
    members
WHERE
        first_name = 'Anna'
    AND last_name = 'Perry';

--SEE IF NEW INDEX IS USED
EXPLAIN PLAN
    FOR
SELECT
    *
FROM
    members
WHERE
        first_name = 'Anna'
    AND last_name = 'Perry';
    
SELECT PLAN_TABLE_OUTPUT FROM TABLE(DBMS_XPLAN.DISPLAY());

/*
-------------------------------------------------------------------------------------------------------------------
| Id  | Operation                            | Name                       | Rows  | Bytes | Cost (%CPU)| Time     |
-------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                     |                            |     1 |    36 |     2   (0)| 00:00:01 |
|   1 |  RESULT CACHE                        | daknhh1jyyhu79ygv8rj1zs0up |     1 |    36 |     2   (0)| 00:00:01 |
|*  2 |   TABLE ACCESS BY INDEX ROWID BATCHED| MEMBERS                    |     1 |    36 |     2   (0)| 00:00:01 |
|   3 |    SORT CLUSTER BY ROWID BATCHED     |                            |     1 |       |     1   (0)| 00:00:01 |
|*  4 |     INDEX SKIP SCAN                  | IND_MEMBERS_01             |     1 |       |     1   (0)| 00:00:01 |
-------------------------------------------------------------------------------------------------------------------
*/